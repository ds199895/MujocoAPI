<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
    <link sizes="16x16" href="_static/favicons/favicon-16x16.png" rel="icon" type="image/png">
    <link sizes="32x32" href="_static/favicons/favicon-32x32.png" rel="icon" type="image/png">
    <link rel="apple-touch-icon" sizes="180x180" href="_static/favicons/favicon-180x180.png" type="image/png">
    <link sizes="180x180" href="_static/favicons/favicon-180x180.png" rel="icon" type="image/png">
    <link sizes="192x192" href="_static/favicons/favicon-192x192.png" rel="icon" type="image/png"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Model Gallery" href="models.html" /><link rel="prev" title="Python Bindings" href="python.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.09.29"/>
        <title>Unity Plug-in - MuJoCo Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=d81277517bee4d6b0349d71bb2661d4890b5617c" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="_static/theme_overrides.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  --font-stack--monospace: Inconsolata,Consolas,ui-monospace,monospace;
  --at-color: #bc103e;
  --at-val-color: #bc103e;
  --body-color: #14234b;
  --color-highlight-on-target: #e5e8ed;
  --primary-header-color: #0053d6;
  --row-odd-background-color: #f0f3f7;
  --rst-content-a-color: #2980b9;
  --secondary-header-color: #123693;
  --wy-menu-vertical-background-color: #0053d6;
  --wy-menu-vertical-color: white;
  --wy-nav-side-background-color: #0053d6;
  --admonition-font-size: 1rem;
  --admonition-title-font-size: 1rem;
  --sidebar-item-font-size: 115%;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --at-color: #ff95a6;
  --at-val-color: #ff95a6;
  --body-color: #14234b;
  --color-admonition-background: #1e1e21;
  --color-highlight-on-target: #3d4045;
  --primary-header-color: #a8caff;
  --row-odd-background-color: #222326;
  --rst-content-a-color: #2980b9;
  --secondary-header-color: #458dff;
  --wy-menu-vertical-background-color: #0053d6;
  --wy-menu-vertical-color: white;
  --wy-nav-side-background-color: #0053d6;
  --admonition-font-size: 1rem;
  --admonition-title-font-size: 1rem;
  --sidebar-item-font-size: 115%;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #272822;
  --color-code-foreground: #f8f8f2;
  --at-color: #ff95a6;
  --at-val-color: #ff95a6;
  --body-color: #14234b;
  --color-admonition-background: #1e1e21;
  --color-highlight-on-target: #3d4045;
  --primary-header-color: #a8caff;
  --row-odd-background-color: #222326;
  --rst-content-a-color: #2980b9;
  --secondary-header-color: #458dff;
  --wy-menu-vertical-background-color: #0053d6;
  --wy-menu-vertical-color: white;
  --wy-nav-side-background-color: #0053d6;
  --admonition-font-size: 1rem;
  --admonition-title-font-size: 1rem;
  --sidebar-item-font-size: 115%;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">MuJoCo Documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/banner.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">MuJoCo Documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="computation.html">Computation</a></li>
<li class="toctree-l1"><a class="reference internal" href="modeling.html">Modeling</a></li>
<li class="toctree-l1"><a class="reference internal" href="XMLreference.html">XML Reference</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="programming/index.html">Programming</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="programming/simulation.html">Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="programming/visualization.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="programming/samples.html">Code samples</a></li>
<li class="toctree-l2"><a class="reference internal" href="programming/extension.html">Extensions</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="APIreference/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="APIreference/APItypes.html">Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="APIreference/APIfunctions.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="APIreference/APIglobals.html">Globals</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Bindings</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Unity Plug-in</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Model Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="unity-plug-in">
<h1>Unity Plug-in<a class="headerlink" href="#unity-plug-in" title="Permalink to this headline">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>The MuJoCo <a class="reference external" href="https://github.com/deepmind/mujoco/tree/main/unity">Unity plug-in</a> allows the Unity Editor and runtime to
use the MuJoCo physics engine.  Users can import MJCF files and edit the models in the Editor.  The plug-in relies on
Unity for most aspects – assets, game logic, simulation time – but uses MuJoCo to determine how objects move, giving
the designer access to MuJoCo’s full API.</p>
</section>
<section id="installation-instructions">
<span id="uinstallation"></span><h2>Installation instructions<a class="headerlink" href="#installation-instructions" title="Permalink to this headline">#</a></h2>
<p>The plug-in directory (available at <a class="reference external" href="https://github.com/deepmind/mujoco/tree/main/unity">https://github.com/deepmind/mujoco/tree/main/unity</a>) includes a <code class="docutils literal notranslate"><span class="pre">package.json</span></code>
file.  Unity’s package manager recognizes this file and will import the plug-in’s C# codebase to your project.  In
addition, Unity also needs the native MuJoCo library, which can be found in the specific platform archive at
<a class="reference external" href="https://github.com/deepmind/mujoco/releases">https://github.com/deepmind/mujoco/releases</a>.</p>
<p>On Unity version 2020.2 and later, the Package Manager will look for the native library file and copy it to the package
directory when the package is imported. Alternatively, you can manually copy the native library to the package directory
and rename it, see platform-specific instructions below. The library can also be copied into any location under your
project’s Assets directory.</p>
<section id="macos">
<h3>MacOS<a class="headerlink" href="#macos" title="Permalink to this headline">#</a></h3>
<p>The MuJoCo app needs to be run at least once before the native library can be used, in order to register the library as
a trusted binary. Then, copy the dynamic library file from
<code class="docutils literal notranslate"><span class="pre">/Applications/MuJoCo.app/Contents/Frameworks/mujoco.framework/Versions/Current/libmujoco.2.3.8.dylib</span></code> (it can be
found by browsing the contents of <code class="docutils literal notranslate"><span class="pre">MuJoCo.app</span></code>) and rename it as <code class="docutils literal notranslate"><span class="pre">mujoco.dylib</span></code>.</p>
</section>
<section id="linux">
<h3>Linux<a class="headerlink" href="#linux" title="Permalink to this headline">#</a></h3>
<p>Expand the <code class="docutils literal notranslate"><span class="pre">tar.gz</span></code> archive to <code class="docutils literal notranslate"><span class="pre">~/.mujoco</span></code>. Then copy the dynamic library from
<code class="docutils literal notranslate"><span class="pre">~/.mujoco/mujoco-2.3.8/lib/libmujoco.so.2.3.8</span></code> and rename it as <code class="docutils literal notranslate"><span class="pre">libmujoco.so</span></code>.</p>
</section>
<section id="windows">
<h3>Windows<a class="headerlink" href="#windows" title="Permalink to this headline">#</a></h3>
<p>Expand the <code class="docutils literal notranslate"><span class="pre">zip</span></code> archive to a directory called <code class="docutils literal notranslate"><span class="pre">MuJoCo</span></code> in your user directory, and copy the file
<code class="docutils literal notranslate"><span class="pre">MuJoCo\bin\mujoco.dll</span></code>.</p>
</section>
</section>
<section id="using-the-plug-in">
<span id="uusing"></span><h2>Using the plug-in<a class="headerlink" href="#using-the-plug-in" title="Permalink to this headline">#</a></h2>
<section id="importer">
<span id="uimporter"></span><h3>Importer<a class="headerlink" href="#importer" title="Permalink to this headline">#</a></h3>
<p>The importer is invoked from the Editor’s <em>Asset</em> menu: click on “Import MuJoCo Scene” and select the XML file with your
model’s MJCF specification.</p>
</section>
<section id="context-menus">
<h3>Context menus<a class="headerlink" href="#context-menus" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Right-clicking a geom component offers two options:</p>
<ul>
<li><p>“Add mesh renderer” adds components to the same game object that render the geom: a standard <code class="docutils literal notranslate"><span class="pre">MeshRenderer</span></code> and a
<code class="docutils literal notranslate"><span class="pre">MjMeshFilter</span></code> that creates a procedural mesh that is recreated when the geom shape properties change.</p></li>
<li><p>“Convert to free object” adds two new game objects: a parent with an <code class="docutils literal notranslate"><span class="pre">MjBody</span></code> component and a sibling with an
<code class="docutils literal notranslate"><span class="pre">MjFreeJoint</span></code> component.  This allows the previously static geom to move about freely in the scene. This action
only applies to “world” geoms – those that do not currently have an <code class="docutils literal notranslate"><span class="pre">MjBody</span></code> parent.</p></li>
</ul>
</li>
<li><p>Right-clicking a Unity Collider offers the option to “Add a matching MuJoCo geom” to the same game object.  Note that
this does not comprise a complete conversion of the physics – Rigidbody, ArticulationBody and Joint configurations
still need to be recreated manually.</p></li>
</ul>
</section>
<section id="mouse-spring">
<h3>Mouse spring<a class="headerlink" href="#mouse-spring" title="Permalink to this headline">#</a></h3>
<p>When the selected game object has an <code class="docutils literal notranslate"><span class="pre">MjBody</span></code> component, spring forces can be applied to this body towards the mouse
cursor through a control-left-drag action in the Scene view.  The 3D position of the spring force origin is found by
projecting the mouse position on a plane defined by the camera X direction and the world Y direction.  Adding the shift
key changes the projection plane to be parallel to the world’s X and Z axes.</p>
</section>
<section id="tips-to-unity-users">
<span id="utips"></span><h3>Tips to Unity users<a class="headerlink" href="#tips-to-unity-users" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>If any compilation or runtime errors are encountered, the state of the system is undefined.  Therefore, we recommend
turning on “Error Pause” in the console window.</p></li>
<li><p>In PhysX, every <cite>Rigidbody</cite> is a “free body”.  In contrast, MuJoCo requires explicit specification of joints for
mobility. For convenience, we provide a context menu for “freeing” a world geom (i.e., an <code class="docutils literal notranslate"><span class="pre">MjGeom</span></code> component without
any <code class="docutils literal notranslate"><span class="pre">MjBody</span></code> ancestor) by adding a parent <code class="docutils literal notranslate"><span class="pre">MjBody</span></code> and a sibling <code class="docutils literal notranslate"><span class="pre">MjFreeJoint</span></code>.</p></li>
<li><p>The plug-in doesn’t support collision detection without physical presence, so there is no built-in notion of trigger
colliders.  The presence or absence of a contact force can be read by adding a touch sensor and reading its
<code class="docutils literal notranslate"><span class="pre">SensorReading</span></code> value (which will correspond to the normal force, see <cite>touch sensor documentation &lt;sensor-touch&gt;</cite>).</p></li>
</ul>
</section>
</section>
<section id="design-principles">
<span id="udesign"></span><h2>Design principles<a class="headerlink" href="#design-principles" title="Permalink to this headline">#</a></h2>
<p>The plug-in design provides a one-to-one mapping between MJCF elements and Unity components.  In order to simulate a
Unity scene (e.g., when the user hits the “play” button in the Editor) using MuJoCo, the plug-in:</p>
<ol class="arabic simple">
<li><p>Scans the GameObject hierarchy in the scene for MuJoCo components.</p></li>
<li><p>Creates an MJCF description and passes it to MuJoCo’s compiler.</p></li>
<li><p>Binds every component to the MuJoCo runtime via the corresponding index in MuJoCo’s data structures. This index is
used for updating Unity’s transforms during simulation.</p></li>
</ol>
<p>This design principle has several implications:</p>
<ul class="simple">
<li><p>Most fields of the Unity components correspond directly to MJCF attributes. Therefore, the user can refer to the
MuJoCo documentation for details on the semantics of different values.</p></li>
<li><p>The layout of MuJoCo components in the GameObject hierarchy determines the layout of the resulting MuJoCo model.
Therefore, we adopt a design rule that <strong>every game object must have at most one MuJoCo component</strong>.</p></li>
<li><p>We rely on Unity for spatial configuration, which requires vector components to be <a class="reference external" href="https://en.wikipedia.org/wiki/Swizzling_(computer_graphics)">swizzled</a> since Unity uses left-handed frames with Y as the
vertical axis, while MuJoCo uses right-handed frames with Z as the vertical axis.</p></li>
<li><p>Unity transform scaling affects positions, orientations, and scale of the entire game object subtree.  However, MuJoCo
doesn’t support collision of skewed cylinders and capsules (skewed spheres are supported via the ellipsoid primitive).
The gizmo for geoms and sites ignores this skew (similarly to PhysX colliders), and will always show the primitive
shape as it will appear to the physics.</p></li>
<li><p>During runtime, changing values of component fields will not trigger scene recreation, so it will have no immediate
effect on the physics.  However, the new values will be loaded upon the next scene recreation.</p></li>
</ul>
<p>Wherever possible, we do things the Unity Way: gravity is read from Unity’s physics settings, and the simulation step is
read from Unity’s Time Manager’s <cite>Fixed Timestep</cite>.  All aspects of appearance (e.g., meshes, materials, and textures)
are handled by Unity’s Asset Manager, and RGBA specifications are done using material assets.</p>
</section>
<section id="implementation-notes">
<span id="unotes"></span><h2>Implementation notes<a class="headerlink" href="#implementation-notes" title="Permalink to this headline">#</a></h2>
<section id="importer-workflow">
<h3>Importer workflow<a class="headerlink" href="#importer-workflow" title="Permalink to this headline">#</a></h3>
<p>When the user selects an MJCF file, the importer first loads
the file in MuJoCo, saves it to a temporary location, and then processes the generated saved file.  This has several
effects:</p>
<ul class="simple">
<li><p>It validates the MJCF - we are guaranteed that the saved MJCF matches the <a class="reference internal" href="XMLreference.html#cschema"><span class="std std-ref">schema</span></a>.</p></li>
<li><p>It validates the assets (materials, meshes, textures) and imports these assets into Unity, as well as creating new
material assets for geom RGBA specification.</p></li>
<li><p>It allows the importer to handle <a class="reference internal" href="XMLreference.html#include"><span class="std std-ref">&lt;include&gt;</span></a> elements without replicating MuJoCo’s file-system
workflow.</p></li>
<li><p>The current version of MuJoCo generates MJCF files with explicit <a class="reference internal" href="XMLreference.html#body-inertial"><span class="std std-ref">&lt;inertial&gt;</span></a> elements, even when
the original model uses geoms for implicit definition of the body inertia.  If you plan to change geom properties of
an imported model, remove these auto-generated <code class="docutils literal notranslate"><span class="pre">MjInertial</span></code> components manually.  We plan to address this in a
future release of MuJoCo.</p></li>
</ul>
<p>In Unity, there is no equivalent to MJCF’s “cascading” <a class="reference internal" href="XMLreference.html#default"><span class="std std-ref">&lt;default&gt;</span></a> clauses.  Therefore, components in
Unity reflect the corresponding elements’ state after applying all the relevant default classes, and the class structure
in the original MJCF is discarded.</p>
</section>
<section id="the-mujoco-scene">
<h3>The MuJoCo Scene<a class="headerlink" href="#the-mujoco-scene" title="Permalink to this headline">#</a></h3>
<p>When a MuJoCo scene is created, the <code class="docutils literal notranslate"><span class="pre">MjScene</span></code> component first scans the scene for all instances of <code class="docutils literal notranslate"><span class="pre">MjComponent</span></code>.
Each component creates its own MJCF element using Unity scene’s spatial structure to describe the model’s initial
reference pose (called <code class="docutils literal notranslate"><span class="pre">qpos0</span></code> in MuJoCo).  <code class="docutils literal notranslate"><span class="pre">MjScene</span></code> combines these XML elements according to the hierarchy of the
respective game objects and creates a single MJCF description of the physics model. It then creates the runtime structs
<code class="docutils literal notranslate"><span class="pre">mjModel</span></code> and <code class="docutils literal notranslate"><span class="pre">mjData</span></code>, and binds each component to the runtime by identifying its unique index.</p>
<p>During runtime, <code class="docutils literal notranslate"><span class="pre">MjScene.FixedUpdate()</span></code> calls <a class="reference internal" href="APIreference/APIfunctions.html#mj-step"><span class="std std-ref">mj_step</span></a>, and then synchronizes the state of each game object
according to the index <code class="docutils literal notranslate"><span class="pre">MjComponent.MujocoId</span></code> identified at binding time.  An <code class="docutils literal notranslate"><span class="pre">MjScene</span></code> component is added
automatically when the application starts (e.g., when the user hits “play”) if and only if the scene includes any MuJoCo
components. If your application’s initialization phase involves ticking the physics while adding game objects and
components, you can call <code class="docutils literal notranslate"><span class="pre">MjScene.CreateScene()</span></code> when the initialization phase is over.</p>
<p>Scene recreation maintains continuity of physics and state in the following way:</p>
<ol class="arabic simple">
<li><p>The position and velocity of joints are cached.</p></li>
<li><p>MuJoCo’s state is reset (to <code class="docutils literal notranslate"><span class="pre">qpos0</span></code>) and Unity transforms are synchronized.</p></li>
<li><p>A new XML is generated, creating a model that has the same <code class="docutils literal notranslate"><span class="pre">qpos0</span></code> as the previous one for the joints that
persisted.</p></li>
<li><p>The MuJoCo state (for the joints that persisted) is set from the cache, and Unity transforms are synchronized.</p></li>
</ol>
<p>Because the MuJoCo library doesn’t (yet) expose an API for scene editing, adding and removing MuJoCo components causes
complete scene recreation.  This can be expensive for large models or if it happens frequently.  We expect this
performance limitation to be lifted in future versions of MuJoCo.</p>
</section>
<section id="global-settings">
<h3>Global Settings<a class="headerlink" href="#global-settings" title="Permalink to this headline">#</a></h3>
<p>An exception to the one-element-per-one-component is the Global Settings component.  This component is responsible for
all the configuration options that are included in the fixed-size, singleton, global elements of MJCF.  Currently it
holds information that corresponds to the <a class="reference internal" href="XMLreference.html#option"><span class="std std-ref">&lt;option&gt;</span></a> and <a class="reference internal" href="XMLreference.html#size"><span class="std std-ref">&lt;size&gt;</span></a> elements, and in the
future it will also be used for the <a class="reference internal" href="XMLreference.html#compiler"><span class="std std-ref">&lt;compiler&gt;</span></a> element, if/when fields there will be relevant to the
Unity plug-in.</p>
</section>
<section id="invoking-the-importer-at-application-runtime">
<h3>Invoking the importer at application runtime<a class="headerlink" href="#invoking-the-importer-at-application-runtime" title="Permalink to this headline">#</a></h3>
<p>The importer is implemented by the class <code class="docutils literal notranslate"><span class="pre">MjImporterWithAssets</span></code>, which is a subclass of <code class="docutils literal notranslate"><span class="pre">MjcfImporter</span></code>.  This parent
class takes an MJCF string and generates the hierarchy of components.  It can be invoked at play-time (it doesn’t
involve Editor functionality), and it doesn’t invoke any functions of the MuJoCo library.  This is useful when MuJoCo
models are generated procedurally (e.g., by some evolutionary process) and/or when an MJCF is imported only to be
converted (e.g., to PhysX, or URDF).  Since it cannot interact with Unity’s <code class="docutils literal notranslate"><span class="pre">AssetManager</span></code> (which is a feature of the
Editor), this class’s functionality is restricted.  Specifically:</p>
<ul class="simple">
<li><p>It ignores all assets (including collision meshes).</p></li>
<li><p>It ignores visuals (including RGBA specifications).</p></li>
</ul>
</section>
<section id="mujoco-sensor-components">
<h3>MuJoCo sensor components<a class="headerlink" href="#mujoco-sensor-components" title="Permalink to this headline">#</a></h3>
<p>MuJoCo defines many sensors, and we were concerned that creating a separate <code class="docutils literal notranslate"><span class="pre">MjComponent</span></code> class for each would lead to
a lot of code duplication.  Therefore, we created classes according to the type of object (actuator / body / geom /
joint / site) whose properties are measured, and the type (scalar / vector / quaternion) of the measured data.</p>
<p>Here’s a table that maps types to sensors:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 40%" />
<col style="width: 25%" />
<col style="width: 35%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Mujoco Object Type</strong></p></td>
<td><p><strong>Data Type</strong></p></td>
<td><p><strong>Sensor Name</strong></p></td>
</tr>
<tr class="row-even"><td><p>Actuator</p></td>
<td><p>Scalar</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">actuatorpos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actuatorvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">actuatorfrc</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Body</p></td>
<td><p>Vector</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subtreecom</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subtreelinvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subtreeangmom</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framepos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framexaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameyaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framezaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framelinvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameangvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framelinacc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameangacc</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Body</p></td>
<td><p>Quaternion</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">framequat</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Geom</p></td>
<td><p>Vector</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">framepos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framexaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameyaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framezaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framelinvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameangvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framelinacc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameangacc</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Geom</p></td>
<td><p>Quaternion</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">framequat</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Joint</p></td>
<td><p>Scalar</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">jointpos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jointvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jointlimitpos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jointlimitvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jointlimitfrc</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Site</p></td>
<td><p>Scalar</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">touch</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rangefinder</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p>Site</p></td>
<td><p>Vector</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">accelerometer</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">velocimeter</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">force</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torque</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gyro</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">magnetometer</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framepos</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framexaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameyaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framezaxis</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framelinvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameangvel</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">framelinacc</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">frameangacc</span></code></p></li>
</ul>
</td>
</tr>
<tr class="row-even"><td><p>Site</p></td>
<td><p>Quaternion</p></td>
<td><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">framequat</span></code></p></li>
</ul>
</td>
</tr>
</tbody>
</table>
</div>
<p>Here’s the same table in reverse, mapping sensors to classes:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<colgroup>
<col style="width: 32%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Sensor Name</p></th>
<th class="head"><p>Plugin Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">accelerometer</span></code></p></td>
<td><p>SiteVector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">actuatorfrc</span></code></p></td>
<td><p>ActuatorScalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">actuatorpos</span></code></p></td>
<td><p>ActuatorScalar</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">actuatorvel</span></code></p></td>
<td><p>ActuatorScalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">force</span></code></p></td>
<td><p>SiteVector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">frameangacc</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">frameangvel</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">framelinacc</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">framelinvel</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">framepos</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">framequat</span></code></p></td>
<td><p>*Quaternion (depends on frame type)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">framexaxis</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">frameyaxis</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">framezaxis</span></code></p></td>
<td><p>*Vector (depends on frame type)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">gyro</span></code></p></td>
<td><p>SiteVector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">jointlimitfrc</span></code></p></td>
<td><p>JointScalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">jointlimitpos</span></code></p></td>
<td><p>JointScalar</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">jointlimitvel</span></code></p></td>
<td><p>JointScalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">jointpos</span></code></p></td>
<td><p>JointScalar</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">jointvel</span></code></p></td>
<td><p>JointScalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">magnetometer</span></code></p></td>
<td><p>SiteVector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">subtreeangmom</span></code></p></td>
<td><p>BodyVector</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">subtreecom</span></code></p></td>
<td><p>BodyVector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">subtreelinvel</span></code></p></td>
<td><p>BodyVector</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">torque</span></code></p></td>
<td><p>SiteVector</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">touch</span></code></p></td>
<td><p>SiteScalar</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">velocimeter</span></code></p></td>
<td><p>SiteVector</p></td>
</tr>
</tbody>
</table>
</div>
<p>The following sensors are not yet implemented:</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">tendonpos</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tendonvel</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ballquat</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">ballangvel</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tendonlimitpos</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tendonlimitvel</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">tendonlimitfrc</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">user</span></code></div>
</div>
</section>
<section id="mesh-shapes">
<h3>Mesh Shapes<a class="headerlink" href="#mesh-shapes" title="Permalink to this headline">#</a></h3>
<p>The plug-in allows using arbitrary Unity meshes for MuJoCo collision.  At model compilation, MuJoCo calls <a class="reference external" href="http://www.qhull.org/">qhull</a> to create a convex hull of the mesh, and uses that for collisions.  Currently the computed
convex hull is not visible in Unity, but we intend to expose it in future versions.</p>
</section>
<section id="interaction-with-external-processes">
<h3>Interaction with External Processes<a class="headerlink" href="#interaction-with-external-processes" title="Permalink to this headline">#</a></h3>
<p>Roboti’s <a class="reference external" href="https://roboti.us/download.html">MuJoCo plug-in for Unity</a> steps the simulation in an external Python
process, and uses Unity only for rendering.  In contrast, our plug-in relies on Unity to step the simulation. It should
be possible to use our plug-in while an external process “drives” the simulation, for example by seting <code class="docutils literal notranslate"><span class="pre">qpos</span></code>,
calling <code class="docutils literal notranslate"><span class="pre">mj_kinematics</span></code>, synchronizing the transforms, and then using Unity to render or compute game logic. In order
to establish communication with an external process, you can use Unity’s <a class="reference external" href="https://github.com/Unity-Technologies/ml-agents">ML-Agents</a> package.</p>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="models.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Model Gallery</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="python.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Python Bindings</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; DeepMind Technologies Limited
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Unity Plug-in</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#installation-instructions">Installation instructions</a><ul>
<li><a class="reference internal" href="#macos">MacOS</a></li>
<li><a class="reference internal" href="#linux">Linux</a></li>
<li><a class="reference internal" href="#windows">Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-the-plug-in">Using the plug-in</a><ul>
<li><a class="reference internal" href="#importer">Importer</a></li>
<li><a class="reference internal" href="#context-menus">Context menus</a></li>
<li><a class="reference internal" href="#mouse-spring">Mouse spring</a></li>
<li><a class="reference internal" href="#tips-to-unity-users">Tips to Unity users</a></li>
</ul>
</li>
<li><a class="reference internal" href="#design-principles">Design principles</a></li>
<li><a class="reference internal" href="#implementation-notes">Implementation notes</a><ul>
<li><a class="reference internal" href="#importer-workflow">Importer workflow</a></li>
<li><a class="reference internal" href="#the-mujoco-scene">The MuJoCo Scene</a></li>
<li><a class="reference internal" href="#global-settings">Global Settings</a></li>
<li><a class="reference internal" href="#invoking-the-importer-at-application-runtime">Invoking the importer at application runtime</a></li>
<li><a class="reference internal" href="#mujoco-sensor-components">MuJoCo sensor components</a></li>
<li><a class="reference internal" href="#mesh-shapes">Mesh Shapes</a></li>
<li><a class="reference internal" href="#interaction-with-external-processes">Interaction with External Processes</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/katex.min.js"></script>
    <script src="_static/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    </body>
</html>